# 스코프

- **스코프는 식별자가 자신이 선언된 위치에 의해 다른 코드가 식별자를 참조할 수 있는 유효한 범위이다**

**함수 스코프(유효범위) 예시**

```js
var x = "global";

function foo() {
  var x = "local";
  console.log(x); // -> 'local'을 출력한다. 전역 변수인 'global'을 참조하지만 함수 몸체 내부에서 'local'이 재선언 되었기 때문
}

foo();

console.log(x); // -> 'global'을 출력한다. 함수 내부에 선언된 var x는 함수 몸체 내에서만 참조할 수 있기 때문
```

- **var 키워드로 선언한 변수는 같은 스코프 내에서 중복 선언이 가능하나, let이나 const 키워드로 선언한 변수는 중복 선언이 불가능하다**

**키워드에 따른 중복 선언 예시**

```js
function foo() {
  var x = 1;
  // var 키워드로 선언된 변수는 같은 스코프 내에서 중복 선언을 허용한다.
  var x = 2;
  console.log(x); // 2
}
foo(); // 함수 호출

function bar() {
  const y = 3;
  let x = 1;
  // let이나 const 키워드로 선언된 변수는 같은 스코프 내에서 중복 선언을 허용하지 않는다.
  const y = 4;
  let x = 2;
  // SyntaxError: Identifier 'x', 'y' has already been declared
}
bar(); // 함수 호출
```

## 스코프의 종류

- **스코프는 코드의 가장 바깥 영역에 위치한 전역 스코프와 함수 몸체 내부에 위치한 지역 스코프로 구분한다 (함수 레벨 스코프의 경우)**
- **전역 스코프를 갖는 전역 변수는 어디서든 참조 가능하다**
- **지역 스코프를 갖는 지역 변수는 자신의 지역 스코프와 하위 지역 스코프에서만 참조 가능하다**

## 스코프 체인

- **함수가 중첩될 수 있기 때문에 함수의 지역 스코프도 중첩될 수 있다**
- **스코프가 함수의 중첩으로 인해 계층적 구조를 갖는것을 스코프 체인이라고 한다**
- **변수 참조 시 자바스크립트 엔진은 변수를 참조하는 스코프에서 시작해서 상위 스코프로 이동하며 선언된 변수를 검색한다**
- **상위 스코프에서 유효한 변수는 하위 스코프에서 자유롭게 참조할 수 있지만 하위 스코프에서 유효한 변수를 상위 스코프에서 참조할 수 없다**
- **자바스크립트 엔진은 스코프 엔진에 의해 변수 및 함수를 검색한다**

**스코프 체인 예시**

```js
function foo() {
  var x = 1;

  function fast() {
    var y = 2;

    function campus() {
      var z = 3;
      console.log(x); // 1
      console.log(y); // 2
    }
    campus();
  }
  fast();
}
foo();
```

## 함수 레벨 스코프

- **함수 레벨 스코프(var 키워드로 선언된 변수)는 함수의 코드 블록만을 지역 스코프로 판단하는 특성이다**

**예시**

```js
var x = 1;
if (true) {
  x = 2; // 블록 레벨 지역 스코프로 변수가 선언되었기 때문에 재할당이 이루어진다
}
console.log(x); // 2

var x = 2;
function foo() {
  var x = 5; // 함수 레벨 지역 스코프로 변수가 선언되었기 때문에 전역에서 참조되지 않는다
}
foo();
console.log(x); // 2
```

## 렉시컬 스코프

- **자바 스크립트는 함수를 어디서 정의했는지에 따라 함수의 상위 스코프를 결정하는 렉시컬 스코프를 따른다. 때문에 함수가 호출된 위치는 상위 스코프 결정에 영향을 주지 않는다**

```js
var x = 1;

function foo() {
  var x = 10;
  bar();
}

function bar() {
  console.log(x);
}

foo(); // 1 -> 전역 변수인 var x = 1 만 참조 가능 bar() 가 호출된 위치는 foo 함수 내부이지만 정의된 위치는 전역이기 때문에 var x = 10 을 참조할 수 없다
bar(); // 1 -> 전역 변수인 var x = 1 만 참조 가능
```

## 강의 내용 요약

- 함수의 중첩에 의해 스코프가 계층적 구조를 갖는다
- 스코프는 전역 스코프와 지역 스코프로 구분된다
- var 키워드는 함수 코드 블록만 지역 스코프로 인정한다(함수 레벨 스코프)
- let, const 키워드를 모든 코드 블록을 지역 스코프로 인정한다(블록 레벨 스코프)
- 자바 스크립트는 함수를 정의한 위치에 따라 스코프를 구분하는 렉시컬 스코프를 따른다
- 런타임 이전 가장 먼저 스코프를 생성한다
- 함수 스코프는 함수 호출에 의해 생성되고 함수가 종료되면 가비지 컬렉터에 의해 메모리 해제 된다
- 전역 코드는 자바스크립트 코드가 로드 되어지자마자 실행된다(전역 스코프에 등록된다)

출처 : https://poiemaweb.com/
